<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wright  Fisher algorithm · ABMEv.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ABMEv.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/changing_environment.html">Changing environments</a></li><li><a class="tocitem" href="../examples/delta_competition_example.html">A first model of meta population</a></li><li><a class="tocitem" href="../examples/genetic_structure.html">Modelling agents with a genetic structure</a></li><li><a class="tocitem" href="../examples/gradient.html">Environmental Gradient</a></li><li><a class="tocitem" href="../examples/sympatric_speciation.html">Modelling Sympatric speciation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="CFM.html">CFM algorithm</a></li><li><a class="tocitem" href="agent.html">Agent properties</a></li><li><a class="tocitem" href="diversity.html">Diversity measures</a></li><li><a class="tocitem" href="gillepsie.html">Gillepsie algorithm</a></li><li><a class="tocitem" href="plots.html">Plotting</a></li><li><a class="tocitem" href="run_world.html">Run the World</a></li><li><a class="tocitem" href="simulation.html">Simulation</a></li><li><a class="tocitem" href="space.html">Space</a></li><li><a class="tocitem" href="utils.html">Utils</a></li><li><a class="tocitem" href="world.html">World</a></li><li class="is-active"><a class="tocitem" href="wright_fisher.html">Wright  Fisher algorithm</a><ul class="internal"><li><a class="tocitem" href="#Foundations"><span>Foundations</span></a></li><li><a class="tocitem" href="#Initial-conditions"><span>Initial conditions</span></a></li><li><a class="tocitem" href="#Scenarios"><span>Scenarios</span></a></li><li><a class="tocitem" href="#Parallelism"><span>Parallelism</span></a></li></ul></li></ul></li><li><span class="tocitem">Mathematics</span><ul><li><a class="tocitem" href="../mathematics/geotrait.html">The geotrait</a></li><li><a class="tocitem" href="../mathematics/mathematical_foundations.html">Mathematical foundations</a></li><li><a class="tocitem" href="../mathematics/minimal_abm.html">Minimal individual based model</a></li><li><a class="tocitem" href="../mathematics/pde.html">PDE Equivalence</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../lib/public.html">Public</a></li></ul></li><li><span class="tocitem">Developping</span><ul><li><a class="tocitem" href="../dev/notes.html">Developping the code</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href="wright_fisher.html">Wright  Fisher algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="wright_fisher.html">Wright  Fisher algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/vboussange/ABMEv.jl/blob/master/docs/src/manual/wright_fisher.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Wright-Fisher-algorithm"><a class="docs-heading-anchor" href="#Wright-Fisher-algorithm">Wright  Fisher algorithm</a><a id="Wright-Fisher-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Wright-Fisher-algorithm" title="Permalink"></a></h1><h2 id="Foundations"><a class="docs-heading-anchor" href="#Foundations">Foundations</a><a id="Foundations-1"></a><a class="docs-heading-anchor-permalink" href="#Foundations" title="Permalink"></a></h2><p>The Wright Fisher process is an individual based model where the number of agents is constant through time. It is helpful to visualize it through marbles in jar:</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/0/0b/Random_sampling_genetic_drift.svg" alt="alt text"/></p><p>At each time step, <span>$N$</span> agents are picked up from previous generation to reproduce. Their number of offspring is proportional to their fitness, calculated as usual with <strong>birth and death rates</strong>.</p><p>It takes thus <strong>only one time step to go trough one generation</strong>. Thus it is more suit- able for numerical simulations. In practice, the Moran and Wright–Fisher models give qualitatively similar results, but genetic drift runs twice as fast in the Moran model.</p><p>From this perspective we can easily get that branches are less stable than in the Gillepsie scenario, for as as time goes to infinity the probability of going extinct is intuitively bigger than 0.</p><h2 id="Initial-conditions"><a class="docs-heading-anchor" href="#Initial-conditions">Initial conditions</a><a id="Initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-conditions" title="Permalink"></a></h2><p>One need to construct the world as an array of agents, which will be the ancestors of the following</p><pre><code class="language-julia">    agents = [Agent( [2e-1]  .* randn(1)) for i in 1:K0]</code></pre><p>The function</p><p>is then called <code>p[&quot;tend&quot;] -1</code> times.</p><h2 id="Scenarios"><a class="docs-heading-anchor" href="#Scenarios">Scenarios</a><a id="Scenarios-1"></a><a class="docs-heading-anchor-permalink" href="#Scenarios" title="Permalink"></a></h2><p>You have several options available concerning the resource implemented and competition:</p><ul><li><code>mode=&quot;std&quot;</code> is the standard mode</li><li><code>mode=&quot;grad2D&quot;</code> corresponds to a an ecological gradient</li></ul><blockquote><p>We are not sure whether this corresponds to the following two images</p></blockquote><ul><li><code>mode=&quot;mountain&quot;</code> corresponds to a scenario where a mountain arises (with an ecological gradient)</li><li><code>mode=&quot;split&quot;</code> corresponds to a scenario where the resource is splitted in two</li><li><code>mode=&quot;graph&quot;</code> this guy is probably not working</li></ul><h2 id="Parallelism"><a class="docs-heading-anchor" href="#Parallelism">Parallelism</a><a id="Parallelism-1"></a><a class="docs-heading-anchor-permalink" href="#Parallelism" title="Permalink"></a></h2><p>You can run your script in parallel, which makes sense for large populations. To do so:</p><pre><code class="language-julia">using Distributed;addprocs()
@everywhere using ABMEv</code></pre><p>Parallelism only works with Wright Fisher model.</p><article class="docstring"><header><a class="docstring-binding" id="ABMEv.updateWorld_WF!-NTuple{5,Any}" href="#ABMEv.updateWorld_WF!-NTuple{5,Any}"><code>ABMEv.updateWorld_WF!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function updateWorld_WF!(world,newworld,C,p,update_rates!,t)
    If p[&quot;reflected&quot;]=true, we reflect only first trait corresponding to geographic position</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/ABMEv.jl/blob/a224d9f1c6388954df4b7dc76b68417249cc58e1/src/algo/ABMEv_WF.jl#L8-L11">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="world.html">« World</a><a class="docs-footer-nextpage" href="../mathematics/geotrait.html">The geotrait »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 12 October 2020 21:26">Monday 12 October 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
